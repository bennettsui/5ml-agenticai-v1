# ===========================================================================
# Fly.io Environment Configuration
# ===========================================================================
# Deploy with: fly secrets import < .env.fly
# Or set individually: fly secrets set KEY=VALUE
#
# Fly Postgres: fly postgres create --name crm-kb-db
#               fly postgres attach crm-kb-db
# Fly Redis:    fly redis create (Upstash)
# ===========================================================================

# Database (Fly Postgres — auto-attached via `fly postgres attach`)
# Fly sets DATABASE_URL automatically; override here if using external DB
DATABASE_URL=postgresql+asyncpg://crm_kb:CHANGE_ME@crm-kb-db.flycast:5432/client_crm_kb

# Redis (Fly Upstash Redis — created via `fly redis create`)
REDIS_URL=redis://default:CHANGE_ME@fly-crm-kb-redis.upstash.io:6379

# Object Storage (Cloudflare R2)
R2_ENDPOINT=https://your-account-id.r2.cloudflarestorage.com
R2_ACCESS_KEY=your-access-key
R2_SECRET_KEY=your-secret-key
R2_BUCKET_DOCUMENTS=client-documents
R2_BUCKET_TASTE=taste-examples

# Auth
JWT_SECRET=CHANGE_ME_USE_openssl_rand_base64_32
JWT_ALGORITHM=HS256
JWT_EXPIRATION_HOURS=8

# AI
ANTHROPIC_API_KEY=sk-ant-your-key-here

# App URLs (Fly.io app names)
# API: deployed as a Fly app (e.g., crm-kb-api.fly.dev)
# Web: deployed as a Fly app (e.g., crm-kb-web.fly.dev)
API_BASE_URL=https://crm-kb-api.fly.dev
WEB_BASE_URL=https://crm-kb-web.fly.dev
NEXT_PUBLIC_API_URL=https://crm-kb-api.fly.dev

# Gmail integration (Google OAuth2)
# Project: gmail-api-integration-486805
# IMPORTANT: Add this redirect URI in Google Cloud Console → Credentials → OAuth 2.0 Client
GOOGLE_CLIENT_ID=916941477967-38ouiore59dp5jbqfpfekoonfn2p624q.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=your-google-client-secret
GOOGLE_REDIRECT_URI=https://crm-kb-api.fly.dev/api/gmail/callback

# AI Orchestration
AI_DAILY_TOKEN_LIMIT=1000000
AI_DAILY_COST_LIMIT_USD=50.0
AI_MAX_TOKENS_PER_CALL=16384
AI_LOOP_DETECTION_THRESHOLD=5
AI_LOOP_DETECTION_WINDOW_SECONDS=60
AI_BUDGET_WARNING_THRESHOLD=0.8
AI_MODEL_DEFAULT=claude-sonnet-4-20250514
AI_MODEL_FALLBACK=claude-haiku-4-5-20251001
